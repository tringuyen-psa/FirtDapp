"use strict";(()=>{var e={};e.id=879,e.ids=[879],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8030:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>g,requestAsyncStorage:()=>d,routeModule:()=>l,serverHooks:()=>x,staticGenerationAsyncStorage:()=>m});var n={};r.r(n),r.d(n,{GET:()=>u,POST:()=>c});var a=r(9303),s=r(8716),o=r(670),i=r(7070),p=r(728);async function u(e){try{if(!p._)throw Error("Database connection not available");let{searchParams:t}=new URL(e.url),r=t.get("month"),n=t.get("year"),a=t.get("payer"),s=t.get("consumers"),o=t.get("limit"),u={};if(r&&n){let e=new Date(`${n}-${parseInt(r).toString().padStart(2,"0")}-01`),t=new Date(`${n}-${(parseInt(r)+1).toString().padStart(2,"0")}-01`);u={...u,expenseDate:{gte:e,lt:t}}}if(a&&"all"!==a&&"Tất cả"!==a&&(u={...u,payer:a}),s){let e=s.split(",");u={...u,consumers:{hasSome:e}}}let c=(await p._.expense.findMany({where:u,orderBy:{expenseDate:"desc"},take:o?parseInt(o):void 0})).map(e=>({...e,amount:Number(e.amount)}));return i.NextResponse.json(c,{headers:{"Cache-Control":"public, max-age=60, stale-while-revalidate=300"}})}catch(e){return console.error("Error fetching expenses:",e),i.NextResponse.json({error:"Failed to fetch expenses",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function c(e){try{if(!p._)throw Error("Database connection not available");let t=await e.json(),r=await p._.expense.create({data:{amount:t.amount,description:t.description,payer:t.payer,consumers:t.consumers,expenseDate:new Date(t.date)}}),n={...r,amount:Number(r.amount)};return i.NextResponse.json(n,{status:201})}catch(e){return console.error("Error creating expense:",e),i.NextResponse.json({error:"Failed to create expense",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/expenses/route",pathname:"/api/expenses",filename:"route",bundlePath:"app/api/expenses/route"},resolvedPagePath:"/home/nvt/Music/Dự \xc1n/FirtDapp/src/app/api/expenses/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:x}=l,h="/api/expenses/route";function g(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:m})}},728:(e,t,r)=>{let n;r.d(t,{_:()=>n}),n=new(require("@prisma/client")).PrismaClient}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,972],()=>r(8030));module.exports=n})();